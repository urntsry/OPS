# THERMOTECH-OPS 雙角色系統設計（更新版）

## 🎯 核心理念

> "同事快速高效，管理者全局掌控"

這不只是一個任務追蹤系統，而是一個**工廠神經系統**：
- 同事是「執行端」：接收指令、快速回報
- 管理者是「大腦」：監控全局、即時決策

---

## 👷 同事角度（Worker Dashboard）

### 登入後的第一畫面
```
┌─────────────────────────────────────────┐
│  👤 張庭憲，早安！                        │
│  今日：2025/11/25 (週一)                  │
├─────────────────────────────────────────┤
│  📋 今日待辦 (5項)                        │
│  ────────────────────────────────────   │
│  [●] 出勤核對加班費          +10分 ⏰08:00 │
│  [●] 支援主管交辦事項        +10分 ⏰09:00 │
│  [ ] 外出施工人員簽到        +10分 ⏰10:00 │
│  [ ] 品質異常處理            +50分 📸必要  │
│  [ ] 316機台例行保養         +20分 📸必要  │
├─────────────────────────────────────────┤
│  🚨 緊急回報                              │
│  📝 查看歷史記錄                          │
│  🏆 我的積分：1,250 (排名 #3)             │
└─────────────────────────────────────────┘
```

### 操作流程
1. **點擊任務** → 看到詳細說明
2. **點擊「完成」** → （如需照片）打開相機 → 拍照 → 上傳 → ✅ 完成！
3. **積分立即增加** → 「叮！+10分」

### 緊急回報流程
```
點擊「🚨 緊急回報」
  ↓
選擇類型：
  - 設備故障
  - 安全事件
  - 物料短缺
  - 其他
  ↓
拍照 + 簡短說明
  ↓
送出 → 立即通知主管！
```

---

## 👔 管理者角度（Manager Command Center）

### 主管「天眼」儀表板
```
┌──────────────────────────────────────────────────────────┐
│  THERMOTECH-OPS 管理中心 | 今日：2025/11/25 (週一)         │
├──────────────────────────────────────────────────────────┤
│                                                            │
│  [視窗1: 即時動態]          [視窗2: 今日任務總覽]           │
│  ┌─────────────────┐      ┌──────────────────────┐      │
│  │ 🟢 張庭憲            │      │ 待完成: 150 項           │      │
│  │    剛完成「出勤核對」│      │ 已完成: 45 項 (30%)     │      │
│  │ 🟡 潘育昌            │      │ 逾期: 3 項 ⚠️          │      │
│  │    正在執行任務中    │      │                          │      │
│  │ 🔴 林珠華            │      │ [詳細列表 →]             │      │
│  │    有2項逾期！       │      └──────────────────────┘      │
│  └─────────────────┘                                      │
│                                                            │
│  [視窗3: 主管行事曆]          [視窗4: 積分排行榜]           │
│  ┌─────────────────┐      ┌──────────────────────┐      │
│  │ 2025/11/25 (今)  │      │ 1. 張庭憲  1,250分 ↑  │      │
│  │ ▸ 張庭憲 (5項)   │      │ 2. 潘育昌  1,180分 ↓  │      │
│  │ ▸ 潘育昌 (3項)   │      │ 3. 林珠華    980分 →  │      │
│  │ ▸ 林珠華 (4項)   │      │ 4. 阮慧喬    850分 ↑  │      │
│  │                  │      │ [查看完整榜單]          │      │
│  │ 2025/11/26 (明)  │      └──────────────────────┘      │
│  │ ▸ 全員 (8項)     │                                      │
│  └─────────────────┘                                      │
│                                                            │
│  [視窗5: 快速操作]            [視窗6: 異常通知]            │
│  ┌─────────────────┐      ┌──────────────────────┐      │
│  │ [➕ 新增交辦事項]│      │ 🚨 3 則未處理           │      │
│  │ [👥 人員管理]    │      │ ① 316機台故障 (張庭憲) │      │
│  │ [⚙️ 任務設定]    │      │ ② 物料短缺 (潘育昌)    │      │
│  │ [📊 報表匯出]    │      │ ③ 安全事件 (林珠華)    │      │
│  └─────────────────┘      └──────────────────────┘      │
└──────────────────────────────────────────────────────────┘
```

### 核心功能

#### 1. 主管行事曆（Calendar View）
- 橫軸：日期（今天、明天、本週、本月）
- 縱軸：人員名單
- 格子內：該人員當天應完成的任務
- 顏色：🟢已完成 🟡進行中 🔴逾期

#### 2. 積分總表（Leaderboard）
```
排名 | 姓名   | 本日 | 本週 | 本月 | 總計  | 趨勢
----|--------|------|------|------|-------|-----
 1  | 張庭憲 |  30  | 150  | 580  | 1,250 | ↑
 2  | 潘育昌 |  20  | 140  | 600  | 1,180 | ↓
 3  | 林珠華 |  10  | 100  | 480  |   980 | →
```

#### 3. 新增交辦事項（Assign New Task）
```
┌────────────────────────────────┐
│  新增交辦事項                   │
├────────────────────────────────┤
│  任務標題: [___________________]│
│  指派給:   [張庭憲 ▼]           │
│  截止時間: [2025/11/26 18:00]   │
│  優先級:   [🔴高 🟡中 🟢低]    │
│  積分:     [+30分]              │
│  需要照片: [✓]                  │
│  說明:     [___________________]│
│                                 │
│  [取消]  [送出並通知]           │
└────────────────────────────────┘
```

---

## 📊 三大功能支柱

### 1. 例行公事追蹤（Routine Tasks）
**資料來源**：`task_definitions` 表
**觸發方式**：Vercel Cron Job 每日 05:30 自動生成

**流程**：
```
每日凌晨 05:30
  ↓
系統掃描 task_definitions (frequency = 'daily')
  ↓
為每位負責人建立 daily_assignments
  ↓
早上 07:50 Line 推播通知
  ↓
員工登入看到任務列表
```

### 2. 突發事件回報（Incident Report）
**特點**：無需預先定義，隨時可發起

**流程**：
```
員工點擊「緊急回報」
  ↓
選擇類型 + 拍照 + 說明
  ↓
系統建立 daily_assignments (is_incident_report = true)
  ↓
立即通知主管（Line + 系統內通知）
  ↓
主管查看並指派處理人員
```

### 3. 交辦事項配發（Ad-hoc Assignment）
**特點**：主管可即時派發新任務

**流程**：
```
主管在「管理中心」點擊「新增交辦事項」
  ↓
填寫表單（任務、指派對象、截止時間、積分）
  ↓
系統建立 daily_assignments
  ↓
立即通知被指派員工（Line + 系統內通知）
  ↓
員工在任務列表中看到新任務
```

---

## 🎨 介面設計原則

### 同事端（PDA Mode）
- ✅ **大按鈕**：至少 60px 高度
- ✅ **單一任務流程**：點擊 → 完成 → 回到列表
- ✅ **即時反饋**：「叮！+10分」音效 + 動畫
- ✅ **顏色區分**：
  - 🟢 綠色 = 已完成
  - 🟡 黃色 = 進行中
  - 🔴 紅色 = 逾期

### 管理者端（Desktop Mode）
- ✅ **多視窗系統**：可同時開啟多個視窗
- ✅ **即時更新**：員工完成任務時，管理者畫面立即更新
- ✅ **資料密度**：表格、圖表、統計數字
- ✅ **快速操作**：右鍵選單、拖曳排程

---

## 🔄 即時通訊機制

### Supabase Realtime
```typescript
// 管理者訂閱所有任務更新
supabase
  .channel('daily_assignments')
  .on('postgres_changes', 
    { event: '*', schema: 'public', table: 'daily_assignments' },
    (payload) => {
      // 即時更新畫面
      updateDashboard(payload)
    }
  )
  .subscribe()
```

---

## 🚀 下一步開發順序

1. ✅ Win95 視覺系統（已完成）
2. ⏳ 登入系統（員工編號登入）
3. ⏳ 同事端任務列表
4. ⏳ 管理者天眼儀表板
5. ⏳ 新增交辦功能
6. ⏳ 緊急回報功能
7. ⏳ Line 通知整合

---

這份文件將成為我們開發的「聖經」，每個功能都按照這個架構來實作！


