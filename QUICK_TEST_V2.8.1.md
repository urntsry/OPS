# 🧪 快速測試指南 - 職能清單 vs 實際任務 v2.8.1

## 🎯 測試目標
驗證「職能清單」與「實際任務」的完全區隔

---

## ✅ 測試步驟

### 【測試 1】設定職能清單後，從任務分配消失

#### 前置條件
```
1. 以 Admin 登入 (70231/70250/A0001)
2. 進入「設定」頁面
3. 進入「任務分類管理」Tab
```

#### 執行步驟
```
1. 點擊「全部」分頁
2. 找到「理布」任務
3. 點擊「編輯」按鈕
4. 在編輯視窗中：
   - 設定「任務類型」為「職能清單」
   - 點擊「儲存」
5. 觀察 Toast 通知
```

#### 預期結果
```
✓ Toast 顯示：「已設定為職能清單並清除分配」
✓ 「理布」仍在「任務分類管理」→「職能清單」中
✓ 「理布」從「任務分類管理」→「實際任務」中消失
```

#### 進階驗證
```
1. 切換到「任務項目」Tab
2. ✓ 「理布」不再出現在任務列表中
3. ✓ 任務分配矩陣中不再顯示「理布」
```

---

### 【測試 2】職能清單不出現在員工行事曆

#### 前置條件
```
1. 確認「理布」已設定為職能清單（測試 1）
2. 以 Admin 登入
3. 進入首頁
```

#### 執行步驟
```
1. 使用「管理者視圖切換器」
2. 在下拉選單選擇任意員工（如：張庭萱 10003）
3. 查看該員工的行事曆
```

#### 預期結果
```
✓ 行事曆中只顯示「實際任務」
✓ 不會顯示「理布」或其他「職能清單」
✓ 「例行公事」列表只顯示實際任務
```

---

### 【測試 3】職能清單改回實際任務

#### 執行步驟
```
1. 進入「設定」→「任務分類管理」
2. 點擊「職能清單」分頁
3. 找到「理布」
4. 點擊「編輯」
5. 設定「任務類型」為「實際任務」
6. 點擊「儲存」
```

#### 預期結果
```
✓ Toast 顯示：「儲存成功」
✓ 「理布」從「職能清單」分頁消失
✓ 「理布」重新出現在「實際任務」分頁
✓ 切換到「任務項目」Tab，「理布」重新出現
✓ 可以重新分配給員工
```

---

### 【測試 4】批量驗證職能清單

#### 建議設定為職能清單的任務
```
根據您的圖片，以下任務應該設定為「職能清單」：

1. 理布
2. 產品縫製/開發
3. 人員訓練/管理
4. 生產線產品檢查
5. 填寫內外皮QC檢驗表
6. 手縫針管理
7. 3D模子管理
8. 產品模子拍照給日本確認
9. 與客戶洽談業務
10. 填寫報價單
11. 處理訂單
12. 與工廠聯繫
... (更多日常工作能力)
```

#### 執行步驟
```
1. 在「任務分類管理」→「全部」
2. 逐一將上述任務設定為「職能清單」
3. 每次儲存後確認 Toast 通知
```

#### 預期結果
```
✓ 每個任務都顯示「已設定為職能清單並清除分配」
✓ 任務項目 Tab 的數量逐漸減少
✓ 職能清單 Tab 的數量逐漸增加
```

---

### 【測試 5】統計數據驗證

#### 執行步驟
```
1. 進入「任務分類管理」
2. 觀察各分頁的數量
```

#### 預期結果（參考，實際數字可能不同）
```
[全部] → 101 項
[職能清單] → 66 項
[實際任務] → 35 項
[模板事件] → 8 項

✓ 全部 = 職能清單 + 實際任務（某些重疊）
✓ 數量符合預期
```

---

### 【測試 6】任務分配只顯示實際任務

#### 執行步驟
```
1. 進入「設定」→「任務項目」Tab
2. 查看任務列表
3. 選擇任意員工
4. 查看任務分配矩陣
```

#### 預期結果
```
✓ 任務列表中不包含「職能清單」
✓ 只顯示「實際任務」
✓ 所有顯示的任務都可以分配給員工
✓ 數量符合「實際任務」Tab 的數量
```

---

### 【測試 7】Console 日誌驗證

#### 執行步驟
```
1. 開啟瀏覽器 Console (F12)
2. 進入「設定」頁面
3. 觀察 Console 輸出
```

#### 預期日誌
```
[SettingsPage] 載入資料...
[SettingsPage] 員工數量: 79
[SettingsPage] 任務數量（全部）: 101
[SettingsPage] 實際任務數量: 35
[SettingsPage] 職能清單數量: 66
```

#### 驗證邏輯
```
✓ 全部任務 = 實際任務 + 職能清單
✓ 101 = 35 + 66 ✓
```

---

### 【測試 8】API 過濾驗證

#### 執行步驟
```
1. 開啟瀏覽器 Console (F12)
2. 進入首頁
3. 觀察 Console 輸出
```

#### 預期日誌
```
[HomePage] 開始載入使用者任務，目標用戶: xxxx
[API] 取得使用者任務定義: xxxx
[API] 成功取得實際任務: 5  ← 數量會根據分配而變化
```

#### 驗證
```
✓ 日誌顯示「實際任務」而非「任務定義」
✓ 數量不包含職能清單
```

---

## 🎯 完整測試流程（建議順序）

```
1. 測試 4：批量設定職能清單（建立測試環境）
   ↓
2. 測試 5：驗證統計數據（確認分類正確）
   ↓
3. 測試 6：驗證任務分配列表（確認過濾正確）
   ↓
4. 測試 2：驗證員工行事曆（確認前端顯示正確）
   ↓
5. 測試 7、8：驗證 Console 日誌（確認 API 正確）
   ↓
6. 測試 3：測試轉換功能（確認雙向轉換正常）
```

---

## 📊 預期結果總覽

### 職能清單（66 項）
```
- 理布
- 產品縫製/開發
- 人員訓練/管理
- 生產線產品檢查
- 填寫內外皮QC檢驗表
- 手縫針管理
- 與客戶洽談業務
- 填寫報價單
... (日常工作能力)

✓ 不出現在任務分配
✓ 不出現在行事曆
✓ 只用於人事管理
```

### 實際任務（35 項）
```
- 日用品採購（每月）
- 環境清潔督導（每週）
- 3D模子管理（每週）
- 設備保養（每週）
- 生產進度回報（每週）
- 產品模子拍照給日本確認（每週）
... (需要執行和追蹤的任務)

✓ 出現在任務分配
✓ 出現在行事曆
✓ 可以追蹤完成狀態
```

---

## 🚨 常見問題

### Q1: 設定為職能清單後，資料會遺失嗎？
```
A: 不會！資料仍保留在資料庫中，只是：
   - 不會出現在任務分配
   - 不會出現在行事曆
   - 可以隨時在「任務分類管理」→「職能清單」中查看
```

### Q2: 可以將職能清單改回實際任務嗎？
```
A: 可以！隨時可以雙向轉換：
   1. 進入「任務分類管理」
   2. 找到該任務
   3. 將「任務類型」改為「實際任務」
   4. 儲存後即可重新分配
```

### Q3: 如何判斷應該設定為哪種類型？
```
A: 職能清單：
   - 日常、持續性的工作能力
   - 不需要特定日期執行
   - 只是能力描述（如：理布、填寫報價單）
   
   實際任務：
   - 有明確的執行時間
   - 需要追蹤是否完成
   - 需要分配給特定人員
   - 會出現在行事曆上
```

---

## 📞 測試支援

如果測試過程中發現任何異常，請記錄：
1. 執行的步驟
2. 預期結果
3. 實際結果
4. Console 錯誤訊息

---

**測試版本**: v2.8.1  
**測試日期**: 2025-11-28  
**測試重點**: 職能清單與實際任務的完全區隔

